<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Girlfriend Countdown</title>
    <style>
        :root {
            --bg: #0f1724;
            --card: #0b1220;
            --accent: #ff6b6b;
            --muted: #9aa4b2
        }

        html,
        body {
            height: 100%
        }

        body {
            margin: 0;
            font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
            background: linear-gradient(180deg, #071022 0%, #071829 50%, #041023 100%);
            color: #e6eef6;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px
        }

        .container {
            width: 100%;
            max-width: 880px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 10px 30px rgba(2, 6, 23, 0.7)
        }

        header {
            display: flex;
            gap: 16px;
            align-items: center
        }

        .logo {
            width: 64px;
            height: 64px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--accent), #ffb27a);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #081020
        }

        h1 {
            margin: 0;
            font-size: 1.4rem
        }

        p.lead {
            margin: 4px 0 0;
            color: var(--muted)
        }

        .countdown {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap
        }

        .time-box {
            background: rgba(255, 255, 255, 0.03);
            padding: 18px;
            border-radius: 12px;
            min-width: 110px;
            text-align: center
        }

        .time-box .num {
            font-size: 2rem;
            font-weight: 700
        }

        .time-box .label {
            font-size: 0.8rem;
            color: var(--muted);
            margin-top: 6px
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 18px;
            align-items: center;
            flex-wrap: wrap
        }

        input[type="text"],
        input[type="datetime-local"],
        select {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.06);
            padding: 10px 12px;
            border-radius: 10px;
            color: inherit;
            min-width: 200px
        }

        button {
            background: linear-gradient(90deg, var(--accent), #ffb27a);
            border: none;
            padding: 10px 14px;
            border-radius: 10px;
            color: #081020;
            font-weight: 700;
            cursor: pointer
        }

        .muted {
            color: var(--muted);
            font-size: 0.9rem
        }

        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 18px;
            gap: 12px
        }

        .celebrate {
            display: inline-flex;
            gap: 8px;
            align-items: center
        }

        .small {
            font-size: 0.85rem;
            color: var(--muted)
        }

        @media (max-width:640px) {
            .time-box {
                min-width: 80px;
                padding: 14px
            }

            .logo {
                width: 52px;
                height: 52px
            }
        }

        #confetti-canvas {
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 40
        }
    </style>
</head>

<body>
    <canvas id="confetti-canvas"></canvas>
    <main class="container" role="main">
        <header>
            <div class="logo">GF</div>
            <div>
                <h1 id="title">Girlfriend Countdown</h1>
                <p class="lead">Countdown to New Year's Eve — your moment to find love (or at least try). ✨</p>
            </div>
        </header>

        <section class="countdown" aria-live="polite" id="countdown" style="margin-top:20px">
            <div class="time-box" aria-hidden="false">
                <div class="num" id="days">0</div>
                <div class="label">Days</div>
            </div>
            <div class="time-box">
                <div class="num" id="hours">00</div>
                <div class="label">Hours</div>
            </div>
            <div class="time-box">
                <div class="num" id="minutes">00</div>
                <div class="label">Minutes</div>
            </div>
            <div class="time-box">
                <div class="num" id="seconds">00</div>
                <div class="label">Seconds</div>
            </div>
        </section>

        <section class="controls">
            <label class="small muted">Your name</label>
            <input id="friendName" type="text" placeholder="e.g. Alex" aria-label="Your name" />

            <label class="small muted">Target</label>
            <select id="preset">
                <option value="nye">New Year's Eve (Dec 31, 23:59:59)</option>
                <option value="custom">Custom date & time...</option>
            </select>

            <input id="customDate" type="datetime-local" style="display:none"
                aria-label="Custom target date and time" />

            <button id="shareBtn">Share</button>
            <button id="resetBtn"
                style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:inherit">Reset</button>
        </section>

        <div class="footer">
            <div class="small" id="message">Counting down to <strong id="targetLabel">New Year's Eve</strong> — get
                ready to make your move!</div>
            <div class="celebrate">
                <div class="small">When the timer hits zero, the celebration begins.</div>
            </div>
        </div>
    </main>

    <script>
        function getDefaultTarget() {
            const now = new Date();
            const year = now.getFullYear();
            let target = new Date(year, 11, 31, 23, 59, 59);
            if (now > target) target = new Date(year + 1, 11, 31, 23, 59, 59);
            return target;
        }

        const daysEl = document.getElementById('days');
        const hoursEl = document.getElementById('hours');
        const minutesEl = document.getElementById('minutes');
        const secondsEl = document.getElementById('seconds');
        const friendNameInput = document.getElementById('friendName');
        const preset = document.getElementById('preset');
        const customDate = document.getElementById('customDate');
        const targetLabel = document.getElementById('targetLabel');
        const message = document.getElementById('message');
        const shareBtn = document.getElementById('shareBtn');
        const resetBtn = document.getElementById('resetBtn');

        function readStateFromHash() {
            const hash = location.hash.slice(1);
            if (!hash) return null;
            const params = new URLSearchParams(hash);
            const name = params.get('name');
            const ts = params.get('ts');
            return { name, ts: ts ? parseInt(ts, 10) : null };
        }

        function writeStateToHash(name, ts) {
            const params = new URLSearchParams();
            if (name) params.set('name', name);
            if (ts) params.set('ts', '' + ts);
            location.hash = params.toString();
        }

        let target = getDefaultTarget();

        (function initFromHash() {
            const s = readStateFromHash();
            if (s) {
                if (s.name) friendNameInput.value = s.name;
                if (s.ts) {
                    const t = new Date(s.ts);
                    if (!isNaN(t)) target = t;
                    targetLabel.textContent = labelForTarget(target);
                }
            }
        })();

        function labelForTarget(d) {
            if (d.getDate() === 31 && d.getMonth() === 11 && d.getHours() === 23 && d.getMinutes() === 59) return "New Year's Eve";
            return d.toLocaleString();
        }

        function updateMessage() {
            const name = friendNameInput.value.trim() || 'you';
            targetLabel.textContent = labelForTarget(target);
            message.innerHTML = `Counting down to <strong>${targetLabel.textContent}</strong> — get ready, <strong>${name}</strong>!`;
        }

        updateMessage();

        preset.addEventListener('change', () => {
            if (preset.value === 'custom') {
                customDate.style.display = 'inline-block';
            } else {
                customDate.style.display = 'none';
                target = getDefaultTarget();
                updateMessage();
            }
        });

        customDate.addEventListener('change', () => {
            const v = customDate.value;
            if (!v) return;
            const t = new Date(v);
            if (isNaN(t)) return;
            target = t;
            updateMessage();
        });

        friendNameInput.addEventListener('input', updateMessage);

        resetBtn.addEventListener('click', () => {
            friendNameInput.value = '';
            preset.value = 'nye';
            customDate.value = '';
            customDate.style.display = 'none';
            target = getDefaultTarget();
            writeStateToHash('', target.getTime());
            updateMessage();
        });

        shareBtn.addEventListener('click', () => {
            const name = friendNameInput.value.trim();
            writeStateToHash(name, target.getTime());
            const shareUrl = location.href;
            if (navigator.share) {
                navigator.share({ title: 'Girlfriend Countdown', text: `Countdown for ${name || 'me'}`, url: shareUrl }).catch(() => { });
            } else {
                navigator.clipboard.writeText(shareUrl).then(() => {
                    alert('Link copied to clipboard — share it with your friends!');
                }).catch(() => {
                    prompt('Copy this link to share:', shareUrl);
                });
            }
        });

        let fired = false;
        function tick() {
            const now = new Date();
            const diff = target - now;
            if (diff <= 0) {
                daysEl.textContent = '0'; hoursEl.textContent = '00'; minutesEl.textContent = '00'; secondsEl.textContent = '00';
                if (!fired) {
                    fired = true; onZero();
                }
                return;
            }
            const sec = Math.floor(diff / 1000) % 60;
            const min = Math.floor(diff / 1000 / 60) % 60;
            const hrs = Math.floor(diff / 1000 / 60 / 60) % 24;
            const days = Math.floor(diff / 1000 / 60 / 60 / 24);
            daysEl.textContent = days;
            hoursEl.textContent = String(hrs).padStart(2, '0');
            minutesEl.textContent = String(min).padStart(2, '0');
            secondsEl.textContent = String(sec).padStart(2, '0');
        }

        setInterval(tick, 250);
        tick();

        (function setupConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            let W = canvas.width = innerWidth;
            let H = canvas.height = innerHeight;
            window.addEventListener('resize', () => { W = canvas.width = innerWidth; H = canvas.height = innerHeight });

            const pieces = [];
            function rand(min, max) { return Math.random() * (max - min) + min }

            function spawn(count) {
                for (let i = 0; i < count; i++) {
                    pieces.push({ x: rand(0, W), y: rand(-H, 0), vx: rand(-2, 2), vy: rand(2, 6), r: rand(6, 12), ttl: rand(3000, 6000), rot: rand(0, Math.PI * 2), vr: rand(-0.1, 0.1), color: `hsl(${Math.floor(rand(0, 360))} 90% 60%)` })
                }
            }

            let last = performance.now();
            function loop(t) {
                const dt = t - last; last = t;
                ctx.clearRect(0, 0, W, H);
                for (let i = pieces.length - 1; i >= 0; i--) {
                    const p = pieces[i];
                    p.x += p.vx * (dt / 16);
                    p.y += p.vy * (dt / 16);
                    p.vy += 0.03 * (dt / 16);
                    p.rot += p.vr * (dt / 16);
                    p.ttl -= dt;
                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate(p.rot);
                    ctx.fillStyle = p.color;
                    ctx.fillRect(-p.r / 2, -p.r / 2, p.r, p.r * 0.6);
                    ctx.restore();
                    if (p.y > H + 50 || p.ttl <= 0) pieces.splice(i, 1);
                }
                requestAnimationFrame(loop);
            }
            requestAnimationFrame(loop);

            window.startConfetti = function () { spawn(180); setTimeout(() => spawn(120), 350); }
        })();

        function onZero() {
            const name = friendNameInput.value.trim() || 'you';
            message.innerHTML = `<strong>Time's up!</strong> — did you find someone, <strong>${name}</strong>? 🎉`;
            if (window.startConfetti) window.startConfetti();
            const old = document.getElementById('title').textContent;
            document.getElementById('title').textContent = 'HAPPY NEW YEAR!';
            setTimeout(() => document.getElementById('title').textContent = old, 6000);
        }

        friendNameInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') { shareBtn.click(); } });

        document.addEventListener('keydown', (e) => { if (e.key === 'Tab') document.body.classList.add('show-focus'); });
    </script>
</body>

</html>